var utils={ARRAYS:{indexOf:function(){if(Array.prototype.indexOf){return function(e,t,n){return e.indexOf(t,n)}}else{return function(e,t,n){var r=e.length;n=n||0;n+=n<0?r:0;for(;n<r;++n){if(e[n]===t){return n}}return-1}}}()},XPATH:{eval:function(e,t,n){var r=document.evaluate(e,t,null,XPathResult.ANY_TYPE,null);if(n&&n===true){var i=[];var s=r.iterateNext();while(s){i.push(s);s=r.iterateNext()}return i}else{return r.iterateNext()}}},URL:{searchObjectify:function(){var e=window.location.search;if(typeof e==="string"&&e!==""){var t={};e=e.slice(1).split("&");var n,r=e.length;for(n=0;n<r;n++){var i=e[n].split("=");t[i[0]]=i[1]}return t}else{return null}}()},JSON:{get:function(e){var t=this;if(typeof e.scope!=="undefined"&&e.scope.remoteAccess){var n=(Math.random()+"").replace(".","");t.jsonpCallback[n]={callback:e.callback,scope:e.scope||t};t.jsonp(n,e.url)}else{return t.ajax(e)}},ajax:function(e){var t=this;var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");n.open("GET",e.url,false);if(e.callback){n.onreadystatechange=function(){if(n.readyState===4){if(n.status>=200&&n.status<300){window.req=n;e.callback.call(e.scope||null,t.decode(n.responseText))}else if(e.errorCallback){e.errorCallback.call(e.scope||null,n)}}}}n.send()},decode:function(json){json=json.substr(0,1)==="/"?json.substr(49).slice(0,-2):json;if(typeof JSON!=="object"){return eval("("+json+")")}return JSON.parse(json)},jsonpPersistence:{},jsonpCallback:{},jsonp:function(e,t){var n=document.head;var r=document.createElement("script");var i="http://tools.globalblue.com/refundCalc/proxy.php?callbackCode="+e+"&callback=utils.JSON.callback&url="+t;r.setAttribute("src",i);n.appendChild(r)},callback:function(e){var t=this;if(e.status.code===200){if(e.callbackCode!==null){var n=t.jsonpCallback[e.callbackCode];n.callback.call(n.scope,t.decode(e.contents))}else{t.jsonpPersistence[e.url]=t.decode(e.contents)}}else{return false}}},EVT:{_cancelDefaultAction:function(e){var t=e?e:window.event;if(t.preventDefault)t.preventDefault();t.returnValue=false;return false},handle:function(e){var t=e?e:window.event;return this._cancelDefaultAction(t)}},ERROR:{debugMode:false,logStack:[],log:function(e){if(this.debugMode){if(typeof console==="object"){console.log(e)}}this.logStack.push(e)}},COMMON:function(){var e={};e.developerMode=false;e.browserInfo=function(){var e={name:null,version:0,OS:"unknown",hasRetinaSupport:function(){return"backgroundSize"in document.body.style}};var t=navigator.appName,n=navigator.userAgent,r;var i=n.match(/(chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);if(i&&(r=n.match(/version\/([\.\d]+)/i))!=null)i[2]=r[1];i=i?[i[1],i[2]]:[t,parseFloat(navigator.appVersion)];e.name=i[0]!==null?i[0]:"unknown";e.version=i[1]!==null?parseFloat(i[1]):0;if(n.indexOf("Windows")!==-1){e.OS="Windows"}else if(n.indexOf("Macintosh")!==-1){e.OS="OSX"}if(e.name==="MSIE"){wgxpath.install()}return e}();e.isIE=e.browserInfo.name==="MSIE";e.loadCSS=function(e){var t=this;var n=null;if(utils.XPATH.eval('//link[contains(@href, "'+e+'")]',document)===null){n=document.createElement("link");n.setAttribute("rel","stylesheet");n.setAttribute("type","text/css");n.setAttribute("href",e+t.cacheBuster());document.getElementsByTagName("head")[0].appendChild(n)}return n};e.cacheBuster=function(){var e=this;if(e.developerMode){return"?s="+(new Date).getTime()}return""},e.browserSupport=function(e){var t=this;e.injectionPoint.className+=e.injectionPoint.className.length>0?" ":"";e.refundInput.className="refundInput";e.injectionPoint.className+=t.browserInfo.name!=="unknown"?t.browserInfo.name.toLowerCase():"";if(t.browserInfo.name==="MSIE"){e.injectionPoint.className+=" ie"+t.browserInfo.version.toFixed(0);if(t.browserInfo.version>=8){e.injectionPoint.className+=" ieNew "}else{e.injectionPoint.className+=" ieOld ";e.refundInput.className+="Old";e.submitRefund.className+="Old"}if(t.browserInfo.version===6&&t.size==="mpu-ext"){var n=utils.XPATH.eval(".//div[@class='top']/h3",e.refundCalc);n.className=e.languageConfig}}if(t.browserInfo.OS!=="unknown"){e.injectionPoint.className+=t.browserInfo.OS==="Windows"?" win":" osx"}if(!t.browserInfo.hasRetinaSupport()){e.injectionPoint.className+=(e.injectionPoint.className.length>0?" ":"")+"noretina"}};return e}()}